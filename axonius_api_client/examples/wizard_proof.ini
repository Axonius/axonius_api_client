[combo1]
type = expression
value = c1, or:c2, and:c3, and:c4, or:c5

[c1]
type = complex_filter
field = installed_software
value =
    name||equals||Google Chrome
    version||not:less_than||99
    version||more_than||72

[iptest]
type = simple_filter
field = public_ips
value = not:equals||1.2.3.4


simple :: and :: agg:hostname :: contains :: abc
complex :: and_not :: agg:installed_software
    name :: equals :: Google Chrome
    version :: less_than :: 99
bracket :: and
    simple :: and_not :: agg:last_seen :: last_hours :: 24
    simple :: and :: agg:os_type :: equals :: Windows

logical operators = and, or, and_not, or_not

--expr-file /tmp/blah.txt
--expr "type=simple logical=or field=agg:hostname operator=contains value=sddsd  dsds 1.2 45 "'(=)" "
--expr "--type start_bracket --logical and" --expr
--type sub --field name --operator equals --value Google Chrome
--type sub --field version --operator less_than --value 99
--type end_bracket

defaults:
    operator would be exists if no value=
    operator would be equals if value=
    logical would be and
    type would be simple

field=agg:hostname value = abc

type = simple [simple start_complex, stop_complex, start_bracket, stop_bracket]
logical = and [and, or, and_not, or_not]
adapter = agg [adapter_name]
field =
operator = equals if value/exists if not value [operator]
value =

type=start_complex, logical=and, field=agg:installed_software
    field=name, operator=equals, value=Google Chrome
    field=version, operator=less_than, value=99
type=end_complex
type=start_bracket logical=and
    type=simple logical=and_not field=agg:last_seen operator=last_hours value=24
    type=simple logical=and field=agg:os_type operator=equals value=Windows
    type=complex logical=and field=agg:installed_software
        sub=name operator=equals value=Google Chrome
        sub=version operator=less_than value=99
type=stop_bracket


field=last_seen
field=last_seen logical=and_not operator=last_days value=24
field=os.type value=Windows
field=installed_software.name value=Google Chrome


type=simple, logical=and_not, field=agg:last_seen, operator=last_hours, value=24
type=simple, logical=and_not, field=agg:last_seen operator=last_hours value=24

[

    {
        "field": "last_seen",
    },
    {
        "type": "simple",
        "adapter": "agg",
        "field": "last_seen",
        "logical": "and_not",
        "operator": "last_days",
        "value": 1
    },
    {
        "type": "complex",
        "field": "installed_software",
        "logical": "and",
        "subs": [
            {"field": "name", "operator": "contains", "value": "google"},
        ]
    },
    {
        "type": "bracket",
        "subs": [
            {"type": "simple", "field": "last_seen"},
            {
                "type": "complex",
                "field": "installed_software",
                "subs": [
                    {"field": "name", "operator": "contains", "value": "google"},
                ]
            },
        ]
    }
]



type=start_bracket
    field=os.type value=OS X
    logical=or field=os.type value=Windows
type=end_bracket
field=is_windows operator=false


type=start_bracket
    field=carbon_black:id
    field=crowd_strike:id logical=or
type=stop_bracket


logical=and_not field=esentire:id
logical=and_not field=carbonblack:id
logical=and_not field=carbonblack:id
logical=and_not field=carbonblack:id
logical=and_not field=carbonblack:id
logical=and_not field=carbonblack:id
logical=and_not field=carbonblack:id
logical=and_not field=name operator=starts value=cyclops
logical=and_not field=name operator=starts value=logger
logical=and_not field=name operator=starts value=nautilus



field=servicenow:install_status, operator=contains, value=deployed
type=start_bracket
    logical=and_not field=servicenow:cores
    logical=and_not field=servicenow:ram
    logical=and_not field=servicenow:hd_gb
type=stop_bracket
type=start_bracket
    field=servicenow:classname operator=contains value=desktop
    logical=or field=servicenow:classname operator=contains value=laptop
type=stop_bracket

